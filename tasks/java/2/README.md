# HTTP Server

## Описание проекта

`HttpServer` - HTTP-сервер, написанный на Java. Он использует NIO (Non-blocking I/O) для обработки HTTP-запросов, позволяя обрабатывать несколько соединений одновременно. Сервер поддерживает маршрутизацию запросов на основе метода и пути, а также использование виртуальных потоков.

## Ключевые особенности
 **NIO:** Использует `java.nio` для обработки сетевых соединений, что обеспечивает масштабируемость.  
 
**Маршрутизация:**  Основана на методе HTTP (GET, POST, и т.д.) и пути URL.


  **Многопоточность:**  Использует пул потоков для обработки входящих запросов. Поддержка виртуальных потоков (Java 19+).



 **Поддержка HTTP/1.1:**  Реализует основные функции HTTP/1.1.


### Основные компоненты:

  **`HttpServer`**:  Основной класс, который запускает и останавливает сервер, принимает соединения и обрабатывает запросы.

   **`HttpRequest`**:  Класс, представляющий HTTP-запрос. Содержит метод, путь, версию HTTP, заголовки и тело запроса.

   **`HttpResponse`**:  Класс, представляющий HTTP-ответ. Содержит код состояния, заголовки и тело ответа.

   **`Handler`**:  Функциональный интерфейс, определяющий, как обрабатывается HTTP-запрос и какой HTTP-ответ должен быть возвращен.

   **`RouteKey`**:  Класс, представляющий собой ключ для маршрутизации, состоящий из HTTP-метода и пути.

### Принцип работы:

1.  Сервер прослушивает входящие соединения на заданном порту.
2.  При получении нового соединения, сервер передает его обработчику в пуле потоков.
3.  Обработчик читает данные из канала, парсит HTTP-запрос и создает объект `HttpRequest`.
4.  На основе метода и пути запроса, сервер находит соответствующий `Handler`.
5.  `Handler` обрабатывает запрос и возвращает объект `HttpResponse`.
6.  Сервер формирует HTTP-ответ и отправляет его клиенту.


### Основные методы

### `HttpServer(String host, int port, int numThreads, boolean isVirtual)`

   `host`: Адрес хоста, на котором будет запущен сервер (например, `"localhost"` или `"0.0.0.0"`).

   `port`: Номер порта для прослушивания входящих соединений.

   `numThreads`: Количество потоков в пуле для обработки запросов.

   `isVirtual`: Флаг, указывающий, использовать ли виртуальные потоки (требуется Java 19+).

### `addHandler(String method, String path, Handler handler)`

  `method`: HTTP-метод (например, `"GET"`, `"POST"`).

   `path`: Путь URL (например, `"/"`).

   `handler`: Реализация интерфейса `Handler`, которая будет вызвана для обработки запроса.

### `start()`

  Запускает сервер и начинает прослушивание входящих соединений.

### `stop()`

 Останавливает сервер, закрывает все соединения и завершает работу пула потоков.

### `HttpRequest`

   `method()`: Возвращает HTTP-метод запроса.

   `path()`: Возвращает путь URL запроса.

   `httpVersion()`: Возвращает версию HTTP.

   `headers()`: Возвращает карту заголовков запроса.

   `body()`: Возвращает тело запроса в виде массива байтов.

   `bodyAsString()`: Возвращает тело запроса в виде строки.

### `HttpResponse`

 `setStatusCode(int statusCode)`: Устанавливает код состояния HTTP-ответа.

   `setHeader(String key, String value)`: Устанавливает заголовок HTTP-ответа.

   `setBody(byte[] body)`: Устанавливает тело HTTP-ответа в виде массива байтов.

   `setBody(String bodyString)`: Устанавливает тело HTTP-ответа в виде строки.

   `getStatusCode()`: Возвращает код состояния HTTP-ответа.

   `getHeaders()`: Возвращает карту заголовков HTTP-ответа.

   `getBody()`: Возвращает тело HTTP-ответа в виде массива байтов.


